(function(){var a;a=this.jQuery,this.notifications=function(){var b,c,d,e;return b="undefined"!=typeof Notification&&null!==Notification,d=!1,e="",this.$=function(b){return null!=b?a=b:void 0},this.defaultIcon=function(a){return null!=a?e=a:void 0},this.scheduleRequestingPermissionOnLoad=function(a){var c;return d=null!=(c=b&&a)?c:b},c=function(a){return d&&"granted"!==a.permission},this.requestPermission=function(){c(Notification)&&Notification.requestPermission(function(a){Notification.permission!==a&&(Notification.permission=a)})},this.onLoadHandler=function(b){return function(){b.requestPermission(),a("body").one("click",b.requestPermission),e=a("link[rel=icon]").attr("href")}}(this),this.scheduleOnLoadEvent=function(b){return function(){b.scheduleRequestingPermissionOnLoad()&&a(window).on("load",b.onLoadHandler)}}(this),this.showNotification=function(b,c){var d,f,g,h,i,j,k,l,m,n,o;if(o=null!=c?c:{},k=o.options,h=o.events,m=o.timeout,g=o.closeOnClick,d=a.Deferred(),null!=k&&null==k.icon&&(k.icon=e),j=new Notification(b,k||{icon:e}),l=function(){return null!=m?setTimeout(function(){return j.close()},m):void 0},f=a(j).on({show:function(){d.resolve(this,l())},error:function(){d.reject(this,l())}}),h)for(i in h)n=h[i],f.on(i,n);return g&&f.on("click",function(){j.close()}),j.events=h,j.timeout=m,j.closeOnClick=g||!1,d.promise()},this}.call({}),this.webSockets=function(){var b,c,d,e,f,g,h,i;return b="undefined"!=typeof WebSocket&&null!==WebSocket,h=function(a,b,c,d){return null==c&&(c=""),null==d&&(d=""),""+a+"//"+b+c+d},g={"http:":"ws:","https:":"wss:"}[location.protocol],f=location.host,c="",i="/notifications/websocket",d=h(g,f,c,i),e="websocket-echo-protocol",this.contextPath=function(a){return null==a&&(a=c),c=a},this.servletPath=function(a){return null==a&&(a=i),i=a},this.available=function(c){var d;return d=a.Deferred(),b?b[c]?d.resolve().promise():(this.connect({server:c,protocol:e}).done(function(a){return a.close(),b[c]=!0,d.resolve()}).fail(function(){return d.reject()}),d.promise()):d.reject().promise()},this.onLoadHandler=function(b){return function(){var e;return b.defaultServer(h(g,f,c||(null!=(e=a("base").attr("href"))?e.replace(new RegExp(""+location.origin+"(.+)/$"),"$1"):void 0),i)),b.available(d)}}(this),this.defaultServer=function(a){return null==a&&(a=d),d=a},this.connect=function(b){var c,e,f,g,h,i,j,k,l,m,n,o,p;return o=b.server,k=b.protocol,i=b.messageHandler,h=b.events,l=b.reconnect,c=a.Deferred(),null==o&&(o=d),p=new WebSocket(o,k),j={send:function(a){return p.send(a)},close:function(){l&&(a(p).off("close.reconnect"),l=!1),p.close()}},e=a(p).on({"open.promise":function(a){c.resolve(j,a)},"error.promise":function(b){l&&(a(p).off("close.reconnect"),l=!1),c.reject(b)}}),(g=function(a){i&&a.on("message.handler",function(a){"function"==typeof i&&i(a.originalEvent.data)})})(e),n=0,(m=function(b){l&&b.on("close.reconnect",function(){setTimeout(function(){var b;p=new WebSocket(o,k),b=a(p).on("open.reconnect",function(a){return n=0,"function"==typeof l.done?l.done(j,a):void 0}),g(b),m(b),f(b,l.events)},(null!=l.interval?l.interval:l.interval=0)+(null!=l.deceleration?l.deceleration:l.deceleration=1e3)*n),++n})})(e),(f=function(a,b){var c,d,e;if(b){e=[];for(c in b)d=b[c],e.push(a.on(c,d));return e}})(e,h),c.promise()},this}.call({})}).call(this);
//# sourceMappingURL=notifications.min.js.map