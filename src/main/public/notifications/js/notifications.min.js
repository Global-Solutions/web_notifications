(function(){var a;a=this.jQuery,this.notifications=function(){var b,c,d,e;return b="undefined"!=typeof Notification&&null!==Notification,d=!1,e="",this.$=function(b){return null!=b?a=b:void 0},this.defaultIcon=function(a){return null!=a?e=a:void 0},this.scheduleRequestingPermissionOnLoad=function(a){var c;return d=null!=(c=b&&a)?c:b},c=function(a){return d&&"granted"!==a.permission},this.requestPermission=function(){c(Notification)&&Notification.requestPermission(function(a){Notification.permission!==a&&(Notification.permission=a)})},this.onLoadHandler=function(b){return function(){b.requestPermission(),a("body").one("click",b.requestPermission),e=a("link[rel=icon]").attr("href")}}(this),this.scheduleOnLoadEvent=function(b){return function(){b.scheduleRequestingPermissionOnLoad()&&a(window).on("load",b.onLoadHandler)}}(this),this.showNotification=function(b,c){var d,f,g,h,i,j,k,l,m,n,o;if(o=null!=c?c:{},k=o.options,h=o.events,m=o.timeout,g=o.closeOnClick,d=a.Deferred(),null!=k&&null==k.icon&&(k.icon=e),j=new Notification(b,k||{icon:e}),l=function(){return null!=m?setTimeout(function(){return j.close()},m):void 0},f=a(j).on({show:function(){d.resolve(this,l())},error:function(){d.reject(this,l())}}),h)for(i in h)n=h[i],f.on(i,n);return g&&f.on("click",function(){j.close()}),j.events=h,j.timeout=m,j.closeOnClick=g||!1,d.promise()},this}.call({}),this.webSockets=function(){var b,c,d,e,f,g,h,i;return b="undefined"!=typeof WebSocket&&null!==WebSocket,h=function(a,b,c,d){return null==c&&(c=""),null==d&&(d=""),""+a+"//"+b+c+d},g={"http:":"ws:","https:":"wss:"}[location.protocol],f=location.host,c="",i="/notifications/websocket",d=h(g,f,c,i),e="websocket-echo-protocol",this.contextPath=function(a){return null==a&&(a=c),c=a},this.servletPath=function(a){return null==a&&(a=i),i=a},this.available=function(c){var d;return d=a.Deferred(),b?b[c]?d.resolve().promise():(this.connect({server:c,protocol:e}).done(function(a){return a.close(),b[c]=!0,d.resolve()}).fail(function(){return d.reject()}),d.promise()):d.reject().promise()},this.onLoadHandler=function(b){return function(){var e;return b.defaultServer(h(g,f,c||(null!=(e=a("base").attr("href"))?e.replace(new RegExp(""+location.origin+"(.+)/$"),"$1"):void 0),i)),b.available(d)}}(this),this.defaultServer=function(a){return null==a&&(a=d),d=a},this.connect=function(b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;return r=b.server,n=b.protocol,l=b.messageHandler,j=b.events,o=b.reconnect,k=b.keepalive,c=a.Deferred(),null==r&&(r=d),t=new WebSocket(r,n),s={},i=function(){return o&&(null!=s.reconnect&&clearTimeout(s.reconnect),a(t).off("close.reconnect"),o=!1),k?(null!=s.keepalive&&clearTimeout(s.keepalive),k=!1):void 0},m={send:function(a){return t.readyState===WebSocket.OPEN?(t.send(a),!0):!1},close:function(){i(),t.close()}},e=a(t).on({"open.promise":function(a){c.resolve(m,a)},"error.promise":function(a){"pending"===c.state&&(i(),c.reject(a))}}),(g=function(a){l&&a.on("message.handler",function(a){"function"==typeof l&&l(a.originalEvent.data)})})(e),h=function(a,b,c,d){var e;return+(null!=(e="function"==typeof a?a(c):void 0)?e:b(null!=a?a:d,c))},q=0,(p=function(b){o&&b.on("close.reconnect",function(){var b;b=h(o.interval,function(a){return a},q,0)+h(o.deceleration,function(a,b){return a*b},q,1e3)+5e3*Math.random(),s.reconnect=setTimeout(function(){var b;t=new WebSocket(r,n),b=a(t).on("open.reconnect",function(a){return q=0,"function"==typeof o.done?o.done(m,a):void 0}),g(b),p(b),f(b,o.events)},Math.max(0,b)),++q})})(e),(f=function(a,b){var c,d;if(b)for(c in b)d=b[c],a.on(c,d)})(e,j),function(){var a,b;a=0,(b=function(){k&&(s.keepalive=setTimeout(function(){var c,d;m.send(null!=(c="function"==typeof k.message?k.message(a):void 0)?c:null!=(d=k.message)?d:""),++a,b()},h(k.interval,function(a){return a},a,6e4)))})()}(),c.promise()},this}.call({})}).call(this);
//# sourceMappingURL=notifications.min.js.map