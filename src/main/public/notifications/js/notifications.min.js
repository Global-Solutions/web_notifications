(function(){var a,b;a=this.jQuery,this.notifications=function(){var b,c,d;return b="undefined"!=typeof Notification&&null!==Notification,c="",this.$=function(b){return null!=b?a=b:void 0},this.defaultIcon=function(a){return null!=a?c=a:void 0},d=function(a){return"granted"!==a.permission},this.requestPermission=function(){var c;return c=a.Deferred(),b?(d(Notification)?Notification.requestPermission(function(a){Notification.permission!==a&&(Notification.permission=a),d(Notification)?c.reject():c.resolve()}):c.resolve(),c.promise()):c.reject().promise()},this.onLoadHandler=function(b){return function(){var d;return d=a.Deferred(),b.requestPermission().done(function(){return d.resolve()}),a("body").one("click",function(){return b.requestPermission().done(function(){return d.resolve()})}),c=a("link[rel=icon]").attr("href"),d.promise()}}(this),this.showNotification=function(b,d){var e,f,g,h,i,j,k,l,m,n,o;if(o=null!=d?d:{},k=o.options,h=o.events,m=o.timeout,g=o.closeOnClick,e=a.Deferred(),null!=k&&null==k.icon&&(k.icon=c),j=new Notification(b,k||{icon:c}),l=function(){return null!=m?setTimeout(function(){return j.close()},m):void 0},f=a(j).on({show:function(){e.resolve(this,l())},error:function(){e.reject(this,l())}}),h)for(i in h)n=h[i],f.on(i,n);return g&&f.on("click",function(){j.close()}),j.events=h,j.timeout=m,j.closeOnClick=g||!1,e.promise()},this}.call({}),b=function(){var b,c;return b="undefined"!=typeof WebSocket&&null!==WebSocket,c=function(b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r;return h=a.Deferred(),r=new WebSocket(b,c),q={},m=function(){f&&(null!=q.reconnect&&clearTimeout(q.reconnect),a(r).off("close.reconnect"),f=!1),g&&(null!=q.keepalive&&clearTimeout(q.keepalive),g=!1)},n={send:function(a){return r.readyState===WebSocket.OPEN?(r.send(a),!0):!1},close:function(){m(),r.close()}},i=a(r).on({"open.promise":function(a){h.resolve(n,a)},"error.promise":function(a){"pending"===h.state&&(m(),h.reject(a))}}),(k=function(a){d&&a.on("message.handler",function(a){"function"==typeof d&&d(a.originalEvent.data)})})(i),l=function(a,b,c,d){var e;return+(null!=(e="function"==typeof a?a(c):void 0)?e:b(null!=a?a:d,c))},p=0,(o=function(d){var e,g,h;f&&(g=l(f.interval,function(a){return a},p,0),e=l(f.deceleration,function(a,b){return a*b},p,1e3),h=g+e+5e3*Math.random(),d.on("close.reconnect",function(){q.reconnect=setTimeout(function(){var d;r=new WebSocket(b,c),d=a(r).on("open.reconnect",function(a){return p=0,"function"==typeof f.done?f.done(n,a):void 0}),o(d),j(d)},Math.max(0,h)),++p}))})(i),(j=function(a,b){var c,d;if(b)for(c in b)d=b[c],a.on(c,d)})(i,e),function(){var a,b;a=0,(b=function(){var c,d,e,f;g&&(c=l(g.interval,function(a){return a},a,6e4),d=null!=(e="function"==typeof g.message?g.message(a):void 0)?e:null!=(f=g.message)?f:"",q.keepalive=setTimeout(function(){n.send(d),++a,b()},c))})()}(),h.promise()},{available:function(d,e){var f;return f=a.Deferred(),b?b[d]?f.resolve().promise():(c(d,e).done(function(a){a.close(),b[d]=!0,f.resolve()}).fail(function(){f.reject()}),f.promise()):f.reject().promise()},register:function(a,b,d,e,f,g){return c(a,b,d,e,f,g)}}},this.webSockets=function(b){var c,d,e,f,g,h,i;return h=function(a,b,c,d){return null==c&&(c=""),null==d&&(d=""),""+a+"//"+b+c+d},g={"http:":"ws:","https:":"wss:"}[location.protocol],f=location.host,c="",i="/notifications/websocket",d=h(g,f,c,i),e="websocket-echo-protocol",null==location.origin&&(location.origin=""+location.protocol+"//"+location.host),this.contextPath=function(a){return null==a&&(a=c),c=a},this.servletPath=function(a){return null==a&&(a=i),i=a},this.available=function(a){return b.available(a,e)},this.onLoadHandler=function(b){return function(){var e,j;return e=a.Deferred(),b.defaultServer(h(g,f,c||(null!=(j=a("base").attr("href"))?j.replace(new RegExp(""+location.origin+"(.+)/$"),"$1"):void 0),i)),b.available(d).done(function(){e.resolve()}),e.promise()}}(this),this.defaultServer=function(a){return null==a&&(a=d),d=a},this.connect=function(c){var e,f,g,h,i,j,k;return k=c.server,i=c.protocol,h=c.messageHandler,f=c.events,j=c.reconnect,g=c.keepalive,e=a.Deferred(),null==k&&(k=d),b.register(k,i,h,f,j,g).done(function(a){e.resolve(a)}).fail(function(){e.reject()}),e.promise()},this}.call(this,b()),this.sharedWebSockets=function(){}.call({})}).call(this);
//# sourceMappingURL=notifications.min.js.map