(function(){var a,b,c,d,e,f,g,h,i,j;f=[],h={},"undefined"!=typeof WebSocket&&null!==WebSocket&&(a={}),c={},b=function(a,b,c,d,e,f){return new Promise(function(g,h){var i,j,k,l,m,n,o,p,q,r,s;s=new WebSocket(a,b),r={},o=void 0,l=function(){e&&(null!=r.reconnect&&clearTimeout(r.reconnect),o&&s.removeEventListener("close",o),e=!1),f&&(null!=r.keepalive&&clearTimeout(r.keepalive),f=!1)},m={send:function(a){return s.readyState===WebSocket.OPEN?(s.send(a),!0):!1},close:function(){l(),s.close()}},n="pending",s.addEventListener("open",function(a){g(m,a),n="resolved"}),s.addEventListener("error",function(a){"pending"===n&&(l(),h(a),n="rejected")}),(j=function(a){c&&a.addEventListener("message",function(a){"function"==typeof c&&c(a.data)})})(s),k=function(a,b,c,d){var e;return+(null!=(e="function"==typeof a?a(c):void 0)?e:b(null!=a?a:d,c))},q=0,(p=function(c){var d,f,g;e&&(f=k(e.interval,function(a){return a},q,0),d=k(e.deceleration,function(a,b){return a*b},q,1e3),g=f+d+5e3*Math.random(),c.addEventListener("close",o=function(){r.reconnect=setTimeout(function(){s=new WebSocket(a,b),s.addEventListener("open",function(a){q=0,"function"==typeof e.done&&e.done(m,a)}),p(s),i(s)},Math.max(0,g)),++q}))})(s),(i=function(a,b){var c,d;if(b)for(c in b)d=b[c],a.addEventListener(c,d)})(s,d),function(){var a,b;a=0,(b=function(){var c,d,e,g;f&&(c=k(f.interval,function(a){return a},a,6e4),d=null!=(e="function"==typeof f.message?f.message(a):void 0)?e:null!=(g=f.message)?g:"",r.keepalive=setTimeout(function(){m.send(d),++a,b()},c))})()}()})},g={pong:function(a){"function"==typeof h[a]&&h[a](),delete h[a]},available:function(c){return new Promise(function(d,e){var f,g,h;return null==a?void e():(h=c.server,g=c.protocol,f=""+h+"-"+g,a[f]?void d():void b(h,g).then(function(b){b.close(),a[f]=!0,d()},function(){e()}))})},register:function(a,b){return new Promise(function(d){var e,f,g;return g=a.server,f=a.protocol,e=""+g+"-"+f,null==c[e]&&(c[e]={con:void 0,ports:[]}),c[e].ports.indexOf(b)>-1?void d("registered"):(c[e].ports.push(b),void d("tobe"))})},send:function(){},close:function(){},keepalive:function(){},reconnect:function(){},message:function(a){var b;b=d(),j(b,a),e(b)}},j=function(a,b){Promise.race(a).then(function(a){a.postMessage(b)})},e=function(a){Promise.all(a.map(function(a){return new Promise(function(b){a.then(function(a){b(a)},function(a){a.close(),b(!1)})})})).then(function(b){a=b.filter(function(a){return a})})},d=function(){return f.map(function(a,b){return new Promise(function(c,d){var e;e=""+Math.random()+":"+b,a.postMessage({ping:e}),h[e]=c.bind(this,a),setTimeout(function(){d(a),delete h[e]},5e3)})})},i=function(a,b,c,d){var e;return e={},e[a]={result:b,args:c,data:d}},this.onconnect=function(a){var b;b=a.ports[0],f.push(b),b.postMessage("yo:"+f.length),console.log("yo"),b.onmessage=function(a){var c,d,e,f;console.log(a),e=a.data;for(c in e)d=e[c],"function"==typeof g[c]&&null!=(f=g[c](d,b))&&f.then(function(a){b.postMessage(i(c,!0,d,a))},function(a){b.postMessage(i(c,!1,d,a))})}}}).call(this);
//# sourceMappingURL=webSocketWorker.min.js.map